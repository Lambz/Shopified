<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<!-- bootstrap CDN-->
	<!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous"> -->

	<!-- Font Awesome CDN-->
	<script src="https://kit.fontawesome.com/99eb92985b.js" crossorigin="anonymous"></script>

	<!-- owl carousel css file cdn link  -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css" />

	<!-- CSS Stylesheet-->
	<link rel="stylesheet" href="./CSS/homePage.css" />
	<style>
		.carousel-control-prev-icon,
		.carousel-control-next-icon {
			filter: brightness(0%);
		}
	</style>
</head>

<body>


	<!-- header section starts  -->

	<header>

		<div class="header-1">

			<a href="#" class="logo"> <i class="fas fa-shopping-bag"></i> shopping </a>

			<div class="form-container">
				<form action="">
					<input type="search" placeholder="search products" id="search" />
					<label for="search" class="fas fa-search"></label>
				</form>
			</div>

		</div>

		<div class="header-2">

			<div id="menu" class="fas fa-bars"></div>

			<nav class="navbar">
				<ul>
					<li><a class="active" href="#home">home</a></li>
					<li><a href="#arrival">arrival</a></li>
					<li><a href="#featured">featured</a></li>
					<li><a href="#gallery">gallery</a></li>
					<li><a href="#deal">deal</a></li>
				</ul>
			</nav>

			<div class="icons">
				<a href="#" class="fas fa-heart"></a>
				<a href="#" class="fas fa-shopping-cart"></a>
				<a href="#" class="fas fa-user"></a>
			</div>

		</div>

	</header>

	<div class="container py-5 my-5">
		<div class="jumbotron">
            <div class="card">
                <div class="card-header container-fluid">
                    <!-- Products -->
                    <div class="row">
                        <!-- <div class="col-md-10"> -->
                            <h3 class="w-75 p-3">Cart</h3>
                        <!-- </div>
                        <div class="col-md-2 p-3 float-right">
                            <a href="addProduct.html" class="btn btn-primary">Add Product</a>
                        </div> -->
                    </div>
                </div>
                <div class="card-body">
                    <!-- <h5 class="card-title">Manage Products</h5>
                    <p class="card-text">You can add, edit and delete your products from here</p> -->
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th scope="col">Name</th>
                                <th scope="col">Seller</th>
                                <th scope="col">Price</th>
                                <th scope="col">Quantity</th>
                                <th scope="col">Total Price</th>
                                <th scope="col"></th>
                            </tr>
                        </thead>
                        <tbody id="tbody">
                            <!-- <tr>
                            <th scope="row">1</th>
                            <td>Mark</td>
                            <td>Otto</td>
                            <td class="text-right">
                                <button class="btn btn-primary">Edit</button>
                                <button class="btn btn-danger">Delete</button>
                            </td>
                          </tr>
                          <tr>
                            <th scope="row">2</th>
                            <td>Jacob</td>
                            <td>Thornton</td>
                            <td>@fat</td>
                          </tr>
                          <tr>
                            <th scope="row">3</th>
                            <td colspan="2">Larry the Bird</td>
                            <td>@twitter</td>
                          </tr> -->
                        </tbody>
                    </table>
                    <div class="text-right" id="totalField">
                        Total: 0
                    </div>
                </div>
            </div>
        </div>
	</div>

	<section class="footer">

		<div class="box-container">

			<div class="box">
				<a href="#" class="logo"> <i class="fas fa-shopping-bag"></i> shopping </a>
				<p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Similique expedita molestiae distinctio
					facere beatae velit, maiores ullam molestias necessitatibus sapiente.</p>
			</div>

			<div class="box">
				<h3>links</h3>
				<a href="#">home</a>
				<a href="#">arrival</a>
				<a href="#">featured</a>
				<a href="#">gallery</a>
				<a href="#">deal</a>
			</div>

			<div class="box">
				<h3>contact us</h3>
				<p> <i class="fas fa-home"></i>
					mumbai, maharashtra,
					india - 400104
				</p>
				<p> <i class="fas fa-phone"></i>
					+910000000
				</p>
				<p> <i class="fas fa-globe"></i>
					xyz@yoursite.com
				</p>
			</div>

		</div>



	</section>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/js/bootstrap.min.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-auth.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-database.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-analytics.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.2.7/firebase-firestore.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.2.8/firebase-storage.js"></script>
	<script src="./scripts/models.js"></script>
	<script src="./scripts/firebaseHandlers.js"></script>
	<script src="./scripts/interface.js"></script>
	<script>
        const tbody = document.getElementById("tbody");
        const totalField = document.getElementById("totalField");
		let user;
		window.onload = function () {
			getUserDetails(true, (u) => {
                console.log(u);
                // console.log(JSON.stringify(u));
				user = u;
                populateTable();
			});
		}
		
        function populateTable()
        {
            let total = 0;
            tbody.innerHTML = ""; 
            user.cart.forEach((product) => {
                tbody.innerHTML += `<tr><td>${product.name}</td><td>${product.seller}</td><td>${product.price}</td><td><input id="${product.id}" type="number" value="${product.quantity}" min="1"/></td><td>${product.price*product.quantity}</td><td><button onclick="updateQuantity('${product.id}')">Update Quanity</button><button onclick="deleteProduct('${product.id}')">Delete</button></td></tr>`
                total += product.quantity*product.price;
            });
            totalField.innerHTML = `Total: ${total}`;
        }

        function updateQuantity(id)
        {
            console.log(id);
            let quantity = document.getElementById(id);
            user.cart.forEach((product) => {
                if(product.id == id)
                {
                    product.quantity = quantity.value;
                }
            });
            updateUser(true, user,updateResult);
        }

        function updateResult(code )
        {
            console.log(code);
            populateTable();
        }

        function deleteProduct(id)
        {
            let i=0;
            let index = -1;
            user.cart.forEach((product) => {
                if(product.id == id)
                {
                    index = i;
                }
                i++;
            });
            user.cart.splice(index,1);
            console.log(user.cart);
            updateUser(true, user,updateResult);
        }
	</script>
</body>

</html>